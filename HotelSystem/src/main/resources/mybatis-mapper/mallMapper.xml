<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="hotel.management.v1.mall.dao.OrderDao">
	<insert id="addOrder">
		INSERT INTO orders VALUES (ORDERS_SEQ_ORDERSNO.nextval,#{username},(select itemno from item where itemname = #{name}))
	</insert>
	<insert id="addOrderDetail">
		INSERT INTO orderdetail VALUES (ORDERS_SEQ_ORDERSNO.currval, sysdate, to_date(#{pickupDay},'MM/DD/YYYY'), #{price}, #{count})
	</insert>
	<select id="findAllOrder" resultType="hotel.management.v1.mall.dto.OrdersDto$OrderList">
		select o.orderno,i.itemname,od.orderdate 
		from (orders o join item i on o.itemno = i.itemno) 
		join orderdetail od on od.orderno = o.orderno where o.username=#{username} 
		order by orderdate desc
	</select>
</mapper>