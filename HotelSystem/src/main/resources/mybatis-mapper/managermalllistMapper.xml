<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="hotel.management.v1.manager.mall.Dao.ManagerMallListDao">
	
	<!-- 관리자 : 김동욱 -->
	
	<select id="mallsearch" resultType="hotel.management.v1.manager.mall.Dto.ManagerMallListDto$MallListSearch">
		select od.username , us.tel , us.name , od.orderno , ord.orderdate , ord.contactdate , 
			   ord.orderprice , ord.orderea 
		from orders od 
		left join orderdetail ord on od.orderno = ord.orderno
		left join users us on od.username = us.username
      <where>
        <if test="name != null and name != ''">
            AND name = #{name}
        </if>
        <if test="tel != null and tel != ''">
            AND tel = #{tel}
        </if>
        <if test="orderNo != null and orderNo != ''">
            AND od.orderNo = #{orderNo}
        </if>
      </where>
	</select>
	
	<select id="contactmallList" resultType="hotel.management.v1.manager.mall.Dto.ManagerMallListDto$MallListSearch">
    	select od.username , us.tel , us.name , od.orderno , ord.orderdate , ord.contactdate , ord.orderprice , ord.orderea 
		from orders od 
		left join orderdetail ord on od.orderno = ord.orderno
		left join users us on od.username = us.username
		where contactdate is not null
    </select>
	 
	<select id="count" resultType="Integer">
		select count(*) from ManagerMallListDto.FindMallList
	</select>
	
	<select id="pagination" resultType="hotel.management.v1.manager.mall.Dto.ManagerMallListDto$FindMallList">
		select * from (select rownum as rnum , 
		od.* from (select orderNo, name, tel from orderdetail order by orderNo desc) 
		od where rownum &lt; #{endRownum}) where rnum &gt; #{startRownum}
	</select>
</mapper>